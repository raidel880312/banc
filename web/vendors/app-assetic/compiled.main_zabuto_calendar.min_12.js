if(typeof jQuery=="undefined"){throw new Error("jQuery is not loaded")}$.fn.zabuto_calendar=function(e){var g=$.extend({},$.fn.zabuto_calendar_defaults(),e);var f=$.fn.zabuto_calendar_language(g.language);g=$.extend({},g,f);this.each(function(){var H=$(this);H.attr("id","zabuto_calendar_"+Math.floor(Math.random()*99999).toString(36));H.data("initYear",g.year);H.data("initMonth",g.month);H.data("monthLabels",g.month_labels);H.data("weekStartsOn",g.weekstartson);H.data("navIcons",g.nav_icon);H.data("dowLabels",g.dow_labels);H.data("showToday",g.today);H.data("showDays",g.show_days);H.data("showPrevious",g.show_previous);H.data("showNext",g.show_next);H.data("cellBorder",g.cell_border);H.data("ajaxSettings",g.ajax);H.data("legendList",g.legend);H.data("actionFunction",g.action);H.data("actionNavFunction",g.action_nav);F();function F(){var j=parseInt(H.data("initYear"));var l=parseInt(H.data("initMonth"))-1;var k=new Date(j,l,1,0,0,0,0);H.data("initDate",k);var i=(H.data("cellBorder")===true)?" table-bordered":"";$tableObj=$('<table class="table'+i+'"></table>');$tableObj=a(H,$tableObj,k.getFullYear(),k.getMonth());$legendObj=D(H);var h=$('<div class="zabuto_calendar" id="'+H.attr("id")+'"></div>');h.append($tableObj);h.append($legendObj);H.append(h)}function a(l,i,h,k){var j=new Date(h,k,1,0,0,0,0);l.data("currDate",j);i.empty();i=b(l,i,h,k);i=x(l,i);i=J(l,i,h,k);G(l,h,k);return i}function D(j){var i=$('<div class="legend" id="'+j.attr("id")+'_legend"></div>');var h=j.data("legendList");if(typeof(h)=="object"&&h.length>0){$(h).each(function(q,n){if(typeof(n)=="object"){if("type" in n){var o="";if("label" in n){o=n.label}switch(n.type){case"text":if(o!==""){var r="";if("badge" in n){if(typeof(n.classname)==="undefined"){var l="badge-event"}else{var l=n.classname}r='<span class="badge '+l+'">'+n.badge+"</span> "}i.append('<span class="legend-'+n.type+'">'+r+o+"</span>")}break;case"block":if(o!==""){o="<span>"+o+"</span>"}if(typeof(n.classname)==="undefined"){var k="event"}else{var k="event-styled "+n.classname}i.append('<span class="legend-'+n.type+'"><ul class="legend"><li class="'+k+'"></li></u>'+o+"</span>");break;case"list":if("list" in n&&typeof(n.list)=="object"&&n.list.length>0){var p=$('<ul class="legend"></u>');$(n.list).each(function(s,t){p.append('<li class="'+t+'"></li>')});i.append(p)}break;case"spacer":i.append('<span class="legend-'+n.type+'"> </span>');break}}}})}return i}function b(o,n,u,N){var v=o.data("navIcons");var P=$('<span><span class="glyphicon glyphicon-chevron-left"></span></span>');var O=$('<span><span class="glyphicon glyphicon-chevron-right"></span></span>');if(typeof(v)==="object"){if("prev" in v){P.html(v.prev)}if("next" in v){O.html(v.next)}}var q=o.data("showPrevious");if(typeof(q)==="number"||q===false){q=C(o.data("showPrevious"),true)}var s=$('<div class="calendar-month-navigation"></div>');s.attr("id",o.attr("id")+"_nav-prev");s.data("navigation","prev");if(q!==false){prevMonth=(N-1);prevYear=u;if(prevMonth==-1){prevYear=(prevYear-1);prevMonth=11}s.data("to",{year:prevYear,month:(prevMonth+1)});s.append(P);if(typeof(o.data("actionNavFunction"))==="function"){s.click(o.data("actionNavFunction"))}s.click(function(K){a(o,n,prevYear,prevMonth)})}var h=o.data("showNext");if(typeof(h)==="number"||h===false){h=C(o.data("showNext"),false)}var j=$('<div class="calendar-month-navigation"></div>');j.attr("id",o.attr("id")+"_nav-next");j.data("navigation","next");if(h!==false){nextMonth=(N+1);nextYear=u;if(nextMonth==12){nextYear=(nextYear+1);nextMonth=0}j.data("to",{year:nextYear,month:(nextMonth+1)});j.append(O);if(typeof(o.data("actionNavFunction"))==="function"){j.click(o.data("actionNavFunction"))}j.click(function(K){a(o,n,nextYear,nextMonth)})}var l=o.data("monthLabels");var i=$("<th></th>").append(s);var t=$("<th></th>").append(j);var k=$("<span>"+l[N]+" "+u+"</span>");k.dblclick(function(){var K=o.data("initDate");a(o,n,K.getFullYear(),K.getMonth())});var r=$('<th colspan="5"></th>');r.append(k);var p=$('<tr class="calendar-month-header"></tr>');p.append(i,r,t);n.append(p);return n}function x(l,o){if(l.data("showDays")===true){var j=l.data("weekStartsOn");var i=l.data("dowLabels");if(j===0){var h=$.extend([],i);var k=new Array(h.pop());i=k.concat(h)}var n=$('<tr class="calendar-dow-header"></tr>');$(i).each(function(q,p){n.append("<th>"+p+"</th>")});o.append(n)}return o}function J(v,O,t,j){var P=v.data("ajaxSettings");var u=w(t,j);var s=z(t,j);var Q=B(t,j,1);var h=B(t,j,s);var R=1;var l=v.data("weekStartsOn");if(l===0){if(h==6){u++}if(Q==6&&(h==0||h==1||h==5)){u--}Q++;if(Q==7){Q=0}}for(var o=0;o<u;o++){var q=$('<tr class="calendar-dow"></tr>');for(var p=0;p<7;p++){if(p<Q||R>s){q.append("<td></td>")}else{var i=v.attr("id")+"_"+I(t,j,R);var k=i+"_day";var n=$('<div id="'+k+'" class="day" >'+R+"</div>");n.data("day",R);if(v.data("showToday")===true){if(y(t,j,R)){n.html('<span class="badge badge-today">'+R+"</span>")}}var r=$('<td id="'+i+'"></td>');r.append(n);r.data("date",I(t,j,R));r.data("hasEvent",false);if(typeof(v.data("actionFunction"))==="function"){r.addClass("dow-clickable");r.click(function(){v.data("selectedDate",$(this).data("date"))});r.click(v.data("actionFunction"))}q.append(r);R++}if(p==6){Q=0}}O.append(q)}return O}function c(l,t,u,r){var s=$('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>');var n=$('<h4 class="modal-title" id="'+l+'_modal_title">'+t+"</h4>");var q=$('<div class="modal-header"></div>');q.append(s);q.append(n);var h=$('<div class="modal-body" id="'+l+'_modal_body">'+u+"</div>");var i=$('<div class="modal-footer" id="'+l+'_modal_footer"></div>');if(typeof(r)!=="undefined"){var o=$("<div>"+r+"</div>");i.append(o)}var k=$('<div class="modal-content"></div>');k.append(q);k.append(h);k.append(i);var p=$('<div class="modal-dialog"></div>');p.append(k);var j=$('<div class="modal fade" id="'+l+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+l+'_modal_title" aria-hidden="true"></div>');j.append(p);j.data("dateId",l);j.attr("dateId",l);return j}function G(i,j,h){var k=i.data("ajaxSettings");i.data("events",false);if(k===false){return true}if(typeof(k)!="object"||typeof(k.url)=="undefined"){alert("Invalid calendar event settings");return false}var l={year:j,month:(h+1)};$.ajax({type:"GET",url:k.url,data:l,dataType:"json"}).done(function(o){var n=[];$.each(o,function(p,q){n.push(o[p])});i.data("events",n);A(i)})}function A(h){var j=h.data("ajaxSettings");var i=h.data("events");if(i!==false){$(i).each(function(s,n){var l=h.attr("id")+"_"+n.date;var r=$("#"+l);var k=$("#"+l+"_day");r.data("hasEvent",true);if(typeof(n.title)!=="undefined"){r.attr("title",n.title)}if(typeof(n.classname)==="undefined"){r.addClass("event")}else{r.addClass("event-styled");k.addClass(n.classname)}if(typeof(n.badge)!=="undefined"&&n.badge!==false){var o=(n.badge===true)?"":" badge-"+n.badge;var p=k.data("day");k.html('<span class="badge badge-event'+o+'">'+p+"</span>")}if(typeof(n.body)!=="undefined"){if("modal" in j&&(j.modal===true)){r.addClass("event-clickable");var q=c(l,n.title,n.body,n.footer);$("body").append(q);$("#"+l).click(function(){$("#"+l+"_modal").modal()})}}})}}function y(l,k,i){var h=new Date();var j=new Date(l,k,i);return(j.toDateString()==h.toDateString())}function I(h,j,i){d=(i<10)?"0"+i:i;m=j+1;m=(m<10)?"0"+m:m;return h+"-"+m+"-"+d}function B(l,k,i){var j=new Date(l,k,i,0,0,0,0);var h=j.getDay();if(h==0){h=6}else{h--}return h}function z(h,j){var i=28;while(E(h,j+1,i+1)){i++}return i}function w(o,i){var j=z(o,i);var l=B(o,i,1);var k=B(o,i,j);var n=j;var h=(l-k);if(h>0){n+=h}return Math.ceil(n/7)}function E(j,i,h){return i>0&&i<13&&j>0&&j<32768&&h>0&&h<=(new Date(j,i,0)).getDate()}function C(l,i){if(l===false){l=0}var k=H.data("currDate");var h=H.data("initDate");var j;j=(h.getFullYear()-k.getFullYear())*12;j-=k.getMonth()+1;j+=h.getMonth();if(i===true){if(j<(parseInt(l)-1)){return true}}else{if(j>=(0-parseInt(l))){return true}}return false}});return this};$.fn.zabuto_calendar_defaults=function(){var g=new Date();var i=g.getFullYear();var h=g.getMonth()+1;var f={language:false,year:i,month:h,show_previous:true,show_next:true,cell_border:false,today:false,show_days:true,weekstartson:1,nav_icon:false,ajax:false,legend:false,action:false,action_nav:false};return f};$.fn.zabuto_calendar_language=function(b){if(typeof(b)=="undefined"||b===false){b="en"}switch(b.toLowerCase()){case"de":return{month_labels:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dow_labels:["Mo","Di","Mi","Do","Fr","Sa","So"]};break;case"en":return{month_labels:["January","February","March","April","May","June","July","August","September","October","November","December"],dow_labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]};break;case"es":return{month_labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dow_labels:["Lu","Ma","Mi","Ju","Vi","Sá","Do"]};break;case"fr":return{month_labels:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dow_labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]};break;case"it":return{month_labels:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dow_labels:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"]};break;case"nl":return{month_labels:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],dow_labels:["Ma","Di","Wo","Do","Vr","Za","Zo"]};break}};